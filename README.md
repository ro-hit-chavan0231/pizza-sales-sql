Project Description: Pizza Hut Sales Analysis using SQL
This project focuses on analyzing Pizza Hut's sales data using Structured Query Language (SQL) to uncover key business insights and support strategic decision-making. The main objective is to understand customer preferences, sales trends, and product performance by querying and exploring a structured pizza sales database.

The analysis is divided into three levels: Basic, Intermediate, and Advanced.

At the Basic level, we started by retrieving fundamental metrics such as the total number of orders and total revenue generated from pizza sales. We identified the highest-priced pizza, the most frequently ordered pizza size, and the top 5 most ordered pizza types based on quantity.

In the Intermediate level, we performed table joins to explore relationships between different datasets. We calculated the total quantity of pizzas ordered for each category and analyzed the distribution of orders across different hours of the day. We also examined the average number of pizzas ordered per day and identified the top 3 pizza types that generated the most revenue.

-- retrive the total number of order place 

SELECT 
    COUNT(*) AS total_orders
FROM
    orders;

-- calculate the total revenue generated by pizza sales

SELECT 
    ROUND(SUM(order_details.quantity * pizzas.price),
            2) AS total_revenue
FROM
    order_details
        JOIN
    pizzas ON order_details.pizza_id = pizzas.pizza_id;

-- identify the highest price pizza

SELECT 
    pizza_types.name, pizzas.price
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
ORDER BY price DESC
LIMIT 1;

-- identify the most common pizza order quantity

SELECT 
    *
FROM
    order_details;
SELECT 
    quantity, COUNT(order_details_id)
FROM
    order_details
GROUP BY quantity;

-- identify the common order size of pizza

SELECT 
    pizzas.size,
    COUNT(order_details.order_details_id) AS sales_count
FROM
    pizzas
        JOIN
    order_details ON pizzas.pizza_id = order_details.pizza_id
GROUP BY pizzas.size
ORDER BY sales_count DESC
LIMIT 1;

-- list the 5 most order pizza types along with their quantity

SELECT 
    name, SUM(quantity) AS order_qnt
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
        JOIN
    order_details ON pizzas.pizza_id = order_details.pizza_id
GROUP BY name
ORDER BY order_qnt DESC
LIMIT 5;

-- joint the necessary table to find the total quantity of each category

SELECT 
    category, SUM(quantity)
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
        JOIN
    order_details ON pizzas.pizza_id = order_details.pizza_id
GROUP BY category;

-- determined the distribution of orders by hour of day.alter

SELECT 
    HOUR(order_time) AS hour, COUNT(order_id) AS order_count
FROM
    orders
GROUP BY HOUR(order_time);

-- join relavant table to find the category wise distribution of pizza

SELECT 
    category, COUNT(name)
FROM
    pizza_types
GROUP BY category;

-- groups the order by date and calculate the average number of pizzas order by day

SELECT 
    ROUND(AVG(avg_sales), 0) AS per_day_avg
FROM
    (SELECT 
        SUM(quantity) AS avg_sales, order_date AS day
    FROM
        order_details
    JOIN orders ON order_details.order_id = orders.order_id
    GROUP BY order_date) AS order_quantity;

-- determined the top most ordered pizza based on revenue

SELECT DISTINCT
    name,
    ROUND(SUM(pizzas.price * order_details.quantity)) AS revenue
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
        JOIN
    order_details ON pizzas.pizza_id = order_details.pizza_id
GROUP BY name
ORDER BY revenue DESC
limit 3;

-- calculate the percentage contribution of each category type as total revenue

SELECT 
    pizza_types.category,
    CONCAT(ROUND(SUM(order_details.quantity * pizzas.price) / (SELECT 
                            ROUND(SUM(order_details.quantity * pizzas.price),
                                        2) AS total_revenue
                        FROM
                            order_details
                                JOIN
                            pizzas ON order_details.pizza_id = pizzas.pizza_id) * 100,
                    2),
            '%') AS percentage
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
        JOIN
    order_details ON pizzas.pizza_id = order_details.pizza_id
GROUP BY pizza_types.category;
